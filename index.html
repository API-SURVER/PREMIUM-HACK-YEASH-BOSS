<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğ˜ğ„ğ€ğ’ğ‡ (ğğ–ğğ„ğ‘)</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>

<style>
html,body{margin:0;height:100%;overflow:hidden;background:#000;font-family:'Segoe UI',sans-serif}
iframe{
position:absolute;
width:100%;
height:100%;
border:none;
z-index:1;
pointer-events:auto; /* iframe normally interactive */
}

/* ---------- OVERLAY FOR INPUT FOCUS ---------- */
#input-overlay{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
z-index:9998;
pointer-events:none; /* by default clicks pass through */
display:none;
}

#input-overlay.active{
display:block;
pointer-events:auto; /* block iframe when input focused */
}

/* ---------- LOADER ---------- */
#loader{
position:fixed;
width:100%;height:100%;
background:#000;
display:flex;
justify-content:center;
align-items:center;
z-index:99999;
overflow:hidden;
}

/* galaxy canvas - full background */
#galaxy{
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
z-index:0;
}

.loaderBox{
width:96vw;height:96vh;
border:4px solid;
border-image:linear-gradient(45deg,red,yellow,lime,cyan,blue,magenta)1;
animation:hue 6s linear infinite;
display:flex;justify-content:center;align-items:center;
z-index:2;
background:rgba(0,0,0,0.3);
backdrop-filter:blur(2px);
}
@keyframes hue{100%{filter:hue-rotate(360deg)}}

.center{position:relative;width:220px;height:220px;display:flex;justify-content:center;align-items:center}
.avatar{width:90px;height:90px;border-radius:50%;z-index:3;animation:glow 2s infinite alternate}
@keyframes glow{from{box-shadow:0 0 20px white}to{box-shadow:0 0 60px cyan,0 0 100px magenta}}

.ring{position:absolute;border-radius:50%;border:2px solid;animation:spin linear infinite}
.r1{width:120px;height:120px;border-color:red;animation-duration:6s}
.r2{width:170px;height:170px;border-color:cyan;animation-duration:10s}
.r3{width:220px;height:220px;border-color:magenta;animation-duration:15s}
@keyframes spin{100%{transform:rotate(360deg)}}

/* falling lines */
.line{
position:absolute;width:2px;height:100%;
background:linear-gradient(transparent,cyan,transparent);
animation:lineMove linear infinite;
}
@keyframes lineMove{0%{transform:translateY(-100%)}100%{transform:translateY(100%)}}

/* ---------- ENHANCED PREDICTION BOX (SMALLER) ---------- */
.box{
width:160px; /* Smaller box */
background:rgba(10,10,20,0.95);
border-radius:12px; /* Slightly smaller radius */
border:2px solid;
border-color:cyan;
color:#0ff;
text-align:center;
padding:10px 8px; /* Reduced padding */
position:fixed;
top:50px;left:30px;
z-index:9999;
cursor:grab;
backdrop-filter:blur(10px);
animation:borderPulse 2s infinite;
user-select:none;
-webkit-user-select:none;
font-size:11px; /* Smaller base font */
box-shadow:0 0 30px rgba(0,255,255,0.5), inset 0 0 20px rgba(0,255,255,0.3);
transition:all 0.1s ease;
/* ensure box is above iframe */
pointer-events:auto;
}

@keyframes borderPulse{
0%{border-color:cyan;box-shadow:0 0 20px cyan}
50%{border-color:magenta;box-shadow:0 0 40px magenta}
100%{border-color:cyan;box-shadow:0 0 20px cyan}
}

.title{
font-size:13px; /* Smaller title */
font-weight:bold;
margin-bottom:6px;
letter-spacing:0.5px;
text-transform:uppercase;
background:linear-gradient(45deg,cyan,magenta);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
text-shadow:0 0 10px rgba(0,255,255,0.5);
}

.signal{
font-size:20px; /* Smaller signal */
font-weight:bold;
color:yellow;
margin:8px 0;
line-height:1.2;
text-shadow:0 0 15px orange;
animation:signalPulse 1s infinite;
}

@keyframes signalPulse{
0%{transform:scale(1);text-shadow:0 0 10px yellow}
50%{transform:scale(1.05);text-shadow:0 0 20px orange, 0 0 30px red}
100%{transform:scale(1);text-shadow:0 0 10px yellow}
}

.countdown{
font-size:16px; /* Smaller countdown */
color:lime;
font-weight:bold;
margin:5px 0;
text-shadow:0 0 10px green;
}

#currentTime{
font-size:10px; /* Smaller time */
color:#0ff;
margin:4px 0;
font-family:monospace;
}

input{
width:120px; /* Smaller input */
padding:8px; /* Smaller padding */
background:rgba(0,0,0,0.9);
border:2px solid cyan;
border-radius:6px;
color:#0ff;
text-align:center;
margin:8px auto;
display:block;
font-size:12px; /* Smaller font */
outline:none;
transition:all 0.3s;
/* ensure input is clickable */
pointer-events:auto;
cursor:text;
}

input:focus{
border-color:magenta;
box-shadow:0 0 20px magenta;
background:rgba(20,20,40,0.9);
}

input::placeholder{
color:rgba(0,255,255,0.5);
font-size:10px; /* Smaller placeholder */
}

button{
padding:6px 20px; /* Smaller button */
border:none;
border-radius:6px;
background:linear-gradient(45deg,cyan,lime);
font-weight:bold;
cursor:pointer;
margin:6px 0;
font-size:14px; /* Smaller font */
color:#000;
transition:all 0.3s;
border:1px solid rgba(255,255,255,0.3);
pointer-events:auto;
}

button:hover{
transform:scale(1.05);
box-shadow:0 0 20px cyan;
}

button:active{
transform:scale(0.95);
}

#wrong{
color:#ff0080;
font-size:12px; /* Smaller text */
display:none;
margin:5px 0;
font-weight:bold;
text-shadow:0 0 10px red;
}

.dev-id{
font-size:8px; /* Smaller dev id */
color:#888;
margin-top:6px;
border-top:1px solid #333;
padding-top:4px;
}

.status-led{
display:inline-block;
width:8px; /* Smaller led */
height:8px;
border-radius:50%;
margin-right:3px;
animation:pulse 1s infinite;
}

@keyframes pulse{
0%,100%{opacity:1;transform:scale(1)}
50%{opacity:0.5;transform:scale(1.2)}
}

.server-status{
font-size:10px; /* Smaller status text */
margin-top:6px;
padding:4px;
border-radius:4px;
background:rgba(0,0,0,0.8);
line-height:1.3;
border:1px solid rgba(255,255,255,0.2);
}

/* DRAG HANDLE STYLE REMOVED */

.status-text{
font-weight:bold;
}

.live-badge{
display:inline-block;
background:rgba(255,0,0,0.2);
color:lime;
padding:2px 8px; /* Smaller badge */
border-radius:12px;
font-size:9px; /* Smaller font */
border:1px solid lime;
}

/* Star animation */
.star{
position:absolute;
background:white;
border-radius:50%;
animation:twinkle linear infinite;
}

@keyframes twinkle{
0%,100%{opacity:0.2;transform:scale(1)}
50%{opacity:1;transform:scale(1.5)}
}
</style>
</head>
<body>

<!-- OVERLAY TO BLOCK IFRAME WHEN INPUT FOCUSED -->
<div id="input-overlay"></div>

<!-- LOADER -->
<div id="loader">
<canvas id="galaxy"></canvas>

<div class="loaderBox">
<div class="center">
<div class="ring r1"></div>
<div class="ring r2"></div>
<div class="ring r3"></div>
<img src="https://iili.io/qf7GtkP.md.jpg" class="avatar">
</div>
</div>
</div>

<!-- MAIN -->
<div id="main" style="display:none">

<iframe src="https://tkclub2.com/#/register?invitationCode=73886231921">
<script>
(function(){
var _0x5f21="aHR0cHM6Ly90a2NsdWIyLmNvbS8jL2hvbWUvQWxsTG90dGVyeUdhbWVzL1dpbkdvP2lkPTE=";
var _0x1a2b="ZGpkaA==";
/* This file is protected. Unauthorized copying is prohibited. */
document.write(decodeURIComponent(escape(atob(_0x5f21))));
console.log("Source Protected. Decryption key needed for source access.");
})();
</script>
</iframe>

<div class="box" id="signalBox">

<div id="loginPart">
<div class="title">ğŸ” YEASH OWNER</div>
<input type="password" id="passInput" placeholder="Enter Password" autocomplete="off">
<button onclick="attemptLogin()">LOGIN</button>
<div id="wrong"></div>
<div class="server-status" id="serverStatus">
<span class="status-led" style="background:#666;"></span>
<span class="status-text">Loading...</span>
</div>
<!-- DRAG HANDLE DIV REMOVED -->
<div class="dev-id">DEV ID: <span id="myDevId"></span></div>
</div>

<div id="signalPart" style="display:none">
<div class="title" id="gameStatus">
<span class="live-badge">ğ˜ğ„ğ€ğ’ğ‡ (ğğ–ğğ„ğ‘)</span>
</div>
<div id="currentTime">--:--:--</div>
<div class="countdown">â±ï¸ <span id="countdown">30</span>s</div>
<div class="signal" id="predicted">ğŸ¯ --</div>
<div class="server-status" id="signalServerStatus">
<span class="status-led" style="background:#666;"></span>
<span id="statusText">Connecting...</span>
</div>
<!-- DRAG HANDLE DIV REMOVED -->
<div class="dev-id">PREDICTION ACTIVE</div>
</div>

</div>
</div>

<script>
// Firebase Configuration
const firebaseConfig = {
    apiKey: "AIzaSyD4DmZX0fyTtXYArFSYcDdrS3GrwwS4nIw",
    authDomain: "viphacksonjit.firebaseapp.com",
    databaseURL: "https://viphacksonjit-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "viphacksonjit",
    storageBucket: "viphacksonjit.firebasestorage.app",
    messagingSenderId: "132891143564",
    appId: "1:132891143564:web:776dd8d8a7039ed981baa9",
    measurementId: "G-QVXJPQX81R"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// Overlay for input focus
const overlay = document.getElementById('input-overlay');
const passInput = document.getElementById('passInput');

// When input gets focus, block iframe
passInput.addEventListener('focus', function() {
    overlay.classList.add('active');
    console.log('Input focused - iframe blocked');
});

// When input loses focus, unblock iframe
passInput.addEventListener('blur', function() {
    overlay.classList.remove('active');
    console.log('Input blurred - iframe unblocked');
});

// Also handle click on input to ensure focus
passInput.addEventListener('click', function(e) {
    e.stopPropagation();
    this.focus();
});

// Create falling lines for loader
for(let i=0;i<25;i++){
let l=document.createElement("div");
l.className="line";
l.style.left=Math.random()*100+"%";
l.style.animationDuration=(2+Math.random()*3)+"s";
document.getElementById('loader').appendChild(l);
}

/* Enhanced galaxy background */
const c=document.getElementById("galaxy");
const ctx=c.getContext("2d");

function resizeCanvas() {
    c.width = window.innerWidth;
    c.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

let stars=[];
for(let i=0;i<400;i++){
stars.push({
x:Math.random()*c.width,
y:Math.random()*c.height,
z:Math.random()*c.width,
size:Math.random()*2+1,
speed:Math.random()*2+2
});
}

function galaxy(){
ctx.fillStyle="rgba(0,0,0,0.2)";
ctx.fillRect(0,0,c.width,c.height);

for(let s of stars){
s.z-=s.speed;
if(s.z<=0){
s.z=c.width;
s.x=Math.random()*c.width;
s.y=Math.random()*c.height;
}

let k=200/s.z;
let px=s.x*k+c.width/2;
let py=s.y*k+c.height/2;
let size=s.size*k;

if(px>=0&&px<=c.width&&py>=0&&py<=c.height){
let brightness=Math.min(1, 200/s.z);
ctx.fillStyle=`rgba(255,255,255,${brightness})`;
ctx.beginPath();
ctx.arc(px, py, size, 0, Math.PI*2);
ctx.fill();
}
}
requestAnimationFrame(galaxy);
}
galaxy();

/* show main after loader */
setTimeout(()=>{
document.getElementById("loader").style.display="none";
document.getElementById("main").style.display="block";
},5000);

/* device id */
let id=localStorage.getItem("dev_id");
if(!id){
id="U-"+Math.floor(Math.random()*1000000);
localStorage.setItem("dev_id",id);
}
document.getElementById('myDevId').innerText=id;

/* Server & Game Status from Firebase */
let serverOnline = false;
let gameOnline = false;

// Listen to server status
database.ref('server').on('value', (snapshot) => {
    serverOnline = snapshot.val() === true;
    updateServerStatus();
});

// Listen to game status
database.ref('game').on('value', (snapshot) => {
    gameOnline = snapshot.val() === true;
    updateGameStatus();
});

function updateServerStatus() {
    const statusEl = document.getElementById('serverStatus');
    const signalStatusEl = document.getElementById('signalServerStatus');
    const statusText = document.getElementById('statusText');
    
    if (serverOnline && gameOnline) {
        if(statusEl) statusEl.innerHTML = '<span class="status-led" style="background:#0f0;"></span><span class="status-text">ğŸŸ¢ SERVER ONLINE</span>';
        if (signalStatusEl) {
            signalStatusEl.innerHTML = '<span class="status-led" style="background:#0f0;"></span><span class="status-text" id="statusText">ğŸŸ¢ ACTIVE</span>';
        }
    } else if (!serverOnline && !gameOnline) {
        if(statusEl) statusEl.innerHTML = '<span class="status-led" style="background:#f00;"></span><span class="status-text">ğŸ”´ SERVER OFFLINE</span>';
        if (signalStatusEl) {
            signalStatusEl.innerHTML = '<span class="status-led" style="background:#f00;"></span><span class="status-text" id="statusText">ğŸ”´ OFFLINE</span>';
        }
    } else {
        if(statusEl) statusEl.innerHTML = '<span class="status-led" style="background:#ff0;"></span><span class="status-text">ğŸŸ¡ PARTIAL</span>';
        if (signalStatusEl) {
            signalStatusEl.innerHTML = '<span class="status-led" style="background:#ff0;"></span><span class="status-text" id="statusText">ğŸŸ¡ PARTIAL</span>';
        }
    }
}

function updateGameStatus() {
    updateServerStatus();
    const gameStatusEl = document.getElementById('gameStatus');
    if(gameStatusEl) {
        gameStatusEl.innerHTML = gameOnline ? '<span class="live-badge"> LIVE</span>' : '<span class="live-badge">ğŸ”´ OFFLINE</span>';
    }
}

/* Password verification from Firebase */
function attemptLogin() {
    const enteredPass = document.getElementById('passInput').value.trim();
    const wrongEl = document.getElementById('wrong');
    
    if (!enteredPass) {
        wrongEl.innerText = 'âŒ ENTER PASSWORD';
        wrongEl.style.display = 'block';
        setTimeout(() => wrongEl.style.display = 'none', 2000);
        return;
    }
    
    // Check if server and game are online
    if (!serverOnline || !gameOnline) {
        wrongEl.innerText = 'â›” SERVER OFFLINE';
        wrongEl.style.display = 'block';
        setTimeout(() => wrongEl.style.display = 'none', 2000);
        return;
    }
    
    // Check password from Firebase
    database.ref('passwords').once('value', (snapshot) => {
        let validPass = false;
        const now = Date.now();
        
        snapshot.forEach(child => {
            const passData = child.val();
            if (passData.password === enteredPass && 
                passData.active === true && 
                passData.expiry > now) {
                validPass = true;
            }
        });
        
        if (validPass) {
            document.getElementById('loginPart').style.display = 'none';
            document.getElementById('signalPart').style.display = 'block';
            startSignal();
            // Remove overlay focus blocker
            overlay.classList.remove('active');
        } else {
            wrongEl.innerText = 'âŒ INVALID PASSWORD';
            wrongEl.style.display = 'block';
            setTimeout(() => wrongEl.style.display = 'none', 2000);
        }
    }).catch(error => {
        console.error('Password check error:', error);
        wrongEl.innerText = 'âš ï¸ CONNECTION ERROR';
        wrongEl.style.display = 'block';
        setTimeout(() => wrongEl.style.display = 'none', 2000);
    });
}

// Allow Enter key to trigger login
document.getElementById('passInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        attemptLogin();
    }
});

/* ========== ULTRA SMOOTH DRAG (Handle removed, entire box draggable except input/button) ========== */
const box = document.getElementById('signalBox');
let isDragging = false;
let startX, startY, startLeft, startTop;

// Mouse down on box (anywhere)
box.addEventListener('mousedown', startDrag);
document.addEventListener('mousemove', drag);
document.addEventListener('mouseup', stopDrag);

// Touch support for mobile
box.addEventListener('touchstart', startDragTouch, {passive: false});
document.addEventListener('touchmove', dragTouch, {passive: false});
document.addEventListener('touchend', stopDrag);

function startDrag(e) {
    // Don't start drag if clicking on input or button
    if(e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') {
        return;
    }
    
    e.preventDefault();
    isDragging = true;
    box.style.cursor = 'grabbing';
    box.style.transition = 'none';
    
    const computedStyle = window.getComputedStyle(box);
    startLeft = parseFloat(computedStyle.left) || box.offsetLeft;
    startTop = parseFloat(computedStyle.top) || box.offsetTop;
    
    startX = e.clientX;
    startY = e.clientY;
}

function startDragTouch(e) {
    // Don't start drag if touching input or button
    if(e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') {
        return;
    }
    
    e.preventDefault();
    if (e.touches.length === 1) {
        isDragging = true;
        box.style.cursor = 'grabbing';
        box.style.transition = 'none';
        
        const computedStyle = window.getComputedStyle(box);
        startLeft = parseFloat(computedStyle.left) || box.offsetLeft;
        startTop = parseFloat(computedStyle.top) || box.offsetTop;
        
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
    }
}

function drag(e) {
    if (!isDragging) return;
    e.preventDefault();
    
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    
    let newLeft = startLeft + dx;
    let newTop = startTop + dy;
    
    const boxWidth = box.offsetWidth;
    const boxHeight = box.offsetHeight;
    
    newLeft = Math.max(0, Math.min(newLeft, window.innerWidth - boxWidth));
    newTop = Math.max(0, Math.min(newTop, window.innerHeight - boxHeight));
    
    box.style.left = newLeft + 'px';
    box.style.top = newTop + 'px';
}

function dragTouch(e) {
    if (!isDragging || e.touches.length !== 1) return;
    e.preventDefault();
    
    const dx = e.touches[0].clientX - startX;
    const dy = e.touches[0].clientY - startY;
    
    let newLeft = startLeft + dx;
    let newTop = startTop + dy;
    
    const boxWidth = box.offsetWidth;
    const boxHeight = box.offsetHeight;
    
    newLeft = Math.max(0, Math.min(newLeft, window.innerWidth - boxWidth));
    newTop = Math.max(0, Math.min(newTop, window.innerHeight - boxHeight));
    
    box.style.left = newLeft + 'px';
    box.style.top = newTop + 'px';
}

function stopDrag() {
    isDragging = false;
    box.style.cursor = 'grab';
    box.style.transition = 'all 0.1s ease';
}

// Keep box in window on resize
window.addEventListener('resize', () => {
    const computedStyle = window.getComputedStyle(box);
    let currentLeft = parseFloat(computedStyle.left) || box.offsetLeft;
    let currentTop = parseFloat(computedStyle.top) || box.offsetTop;
    
    const boxWidth = box.offsetWidth;
    const boxHeight = box.offsetHeight;
    
    currentLeft = Math.max(0, Math.min(currentLeft, window.innerWidth - boxWidth));
    currentTop = Math.max(0, Math.min(currentTop, window.innerHeight - boxHeight));
    
    box.style.left = currentLeft + 'px';
    box.style.top = currentTop + 'px';
});

/* signal system */
let currentInterval=-1;
let predictedElement = document.getElementById('predicted');
let countdownElement = document.getElementById('countdown');
let currentTimeElement = document.getElementById('currentTime');

function startSignal(){
    loop();
}

function loop(){
    if (!serverOnline || !gameOnline) {
        if (predictedElement) predictedElement.innerHTML = 'âš« WAITING';
        if (countdownElement) countdownElement.innerHTML = '--';
    } else {
        let now=new Date();
        let ms=now.getTime();
        let id=Math.floor(ms/30000);

        if(id!==currentInterval){
            currentInterval=id;
            generateSignal();
        }

        let cd=30-((ms%30000)/1000);
        if (countdownElement) countdownElement.innerHTML=Math.ceil(cd);
        if (currentTimeElement) currentTimeElement.innerHTML=now.toLocaleTimeString();
        
        updateGameStatus();
    }
    
    requestAnimationFrame(loop);
}

function generateSignal(){
    if (!serverOnline || !gameOnline) return;
    
    const signals = [
        "ğŸ¯ BIG 7,9", "ğŸ¯ SML 1,3", "ğŸ¯ SML 2,4", "ğŸ¯ BIG 6,8", 
        "ğŸ¯ BIG 5,9", "ğŸ¯ SML 0,4"
    ];
    
    
    
    if (predictedElement) {
        let randomSignal = signals[Math.floor(Math.random() * signals.length)];
        predictedElement.innerHTML = randomSignal;
        
        // Add animation effect
        predictedElement.style.animation = 'none';
        predictedElement.offsetHeight;
        predictedElement.style.animation = 'signalPulse 0.5s';
    }
}// Debug: Log when input is clicked
console.log('Page loaded - Input should be clickable');
</script>

</body>
</html>